<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>MUltiscale Comparison and Heterogeneity Analyses • mucha</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="MUltiscale Comparison and Heterogeneity Analyses">
<meta name="description" content="This package ports MHM and CMP approaches to R since the initial Java programs are no longer maintained. They are essentially thin wrappers on top of terra package functions and stick to original Gaucherel's implementation while allowing easy customization, inspection and tweaking at every step. Both MHM and CMP propose a methodology to capture the local and scaling variations of landscapes, or anything that can be turned into rasters. MHM works on a single raster, while CMP works on a pair of rasters. Both use moving windows and summary functions to end up with several rasters, one per window size, that are eventually combined, using a custom function, and summarized using a scaling profile plot.">
<meta property="og:description" content="This package ports MHM and CMP approaches to R since the initial Java programs are no longer maintained. They are essentially thin wrappers on top of terra package functions and stick to original Gaucherel's implementation while allowing easy customization, inspection and tweaking at every step. Both MHM and CMP propose a methodology to capture the local and scaling variations of landscapes, or anything that can be turned into rasters. MHM works on a single raster, while CMP works on a pair of rasters. Both use moving windows and summary functions to end up with several rasters, one per window size, that are eventually combined, using a custom function, and summarized using a scaling profile plot.">
<meta property="og:image" content="https://vbonhomme.github.io/mucha/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mucha</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/intro.html">manual</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vbonhomme/mucha/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="mucha">mucha<a class="anchor" aria-label="anchor" href="#mucha"></a>
</h1>
</div>
<!-- badges:
[![License: GPL (>= 3)](https://img.shields.io/badge/license-GPL (>= 3)-blue.svg)](https://cran.r-project.org/web/licenses/GPL (>= 3))
[![](https://www.r-pkg.org/badges/version/mucha)](https://cran.r-project.org/package=mucha)
[![CRAN checks](https://cranchecks.info/badges/summary/mucha)](https://cran.r-project.org/web/checks/check_results_mucha.html)
[![](http://cranlogs.r-pkg.org/badges/last-month/mucha)](https://cran.r-project.org/package=mucha)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
&#10;end -->
<div class="section level2">
<h2 id="in-brief">In brief<a class="anchor" aria-label="anchor" href="#in-brief"></a>
</h2>
<p>The primary goal of CMP package is to port the MHM and CMP softwares by Gaucherel and colleagues to R. They were originally written in Java and are no longer maintained (but see <a href="http://amap-dev.cirad.fr/projects/mhm" class="external-link">MHM</a> and <a href="http://amap-dev.cirad.fr/projects/cmp" class="external-link">CMP</a> legacy pages).</p>
<p>Both MHM and CMP approaches propose a methodology to capture the local and scaling variations of landscapes, or anything that can be turned into rasters.</p>
<p>MHM works on a single raster, while CMP works on a pair of rasters. Both use moving windows and summary functions to end up with several rasters (aka the monoscale maps) one per window size, that are eventually combined, using a custom function to obtain a multiscale map, and summarized using a profile plot.</p>
<p>A graphical user interface (in shiny) will probably be released soon, so that people not proficient in R still could do some MHM and CMP analyses, just as for original softwares.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the last release on CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"mucha"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of mucha from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"vbonhomme/mucha"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mhm-example">MHM Example<a class="anchor" aria-label="anchor" href="#mhm-example"></a>
</h2>
<p>Below, we will use an example raster on which we will apply an MHM approach with default parameters (see [MHM]). Then we will plot all successive layers and the aggregated version of them using an arithmetic mean. Finally, we display a vanilla boxplot of the resulting profile plot.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vbonhomme/mucha" class="external-link">mucha</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.7.29</span></span>
<span></span>
<span><span class="co"># load an example raster and downsize it</span></span>
<span><span class="co"># to make things a little faster</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/import_example.html">import_example</a></span><span class="op">(</span><span class="st">"l1.tif"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="reference/raster_helpers.html">raster_resample</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># chitchat</span></span>
<span><span class="fu"><a href="reference/raster_helpers.html">raster_summary</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span></span>
<span><span class="co">#&gt; &gt;&gt;&gt; [160x120] raster (likely categorical)</span></span>
<span><span class="co">#&gt; &gt;&gt;&gt; with following (9) classes: 1, 4, 9, 11, 12, 13, 14, 15, 16</span></span>
<span><span class="co">#&gt; &gt;&gt;&gt; 13987 NA (72.8%) among 19200 values</span></span>
<span></span>
<span><span class="co"># plot it -- you can also use terra::plot</span></span>
<span><span class="fu"><a href="reference/p.html">p</a></span><span class="op">(</span><span class="va">l</span>, title <span class="op">=</span> <span class="st">"Kottoli landscape"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
<p>Now calculate contagion at three different scales. We use the cpp version of contagion to speed up calculations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#&gt;  ■■■■■■■■■■■■■■■■■■■■■■■ 75% | ETA: 1s </span></span></code></pre></div>
<p>Now let’s plot all monoscale maps:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/p.html">p</a></span><span class="op">(</span><span class="va">l_mhm</span>, multi_title <span class="op">=</span> <span class="st">"Monoscale maps (contagion)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>Finally, we calculate and show a multiscale map and a profile plot:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/app.html" class="external-link">app</a></span><span class="op">(</span><span class="va">l_mhm</span>, <span class="va">mean</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="reference/p.html">p</a></span><span class="op">(</span>multi_title <span class="op">=</span> <span class="st">"Multiscale map (averaged contagion)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ms_profile.html">ms_profile</a></span><span class="op">(</span><span class="va">l_mhm</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-2.png" width="100%"></p>
<p>CMP works pretty much the same but with two landscapes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we import another one landscape</span></span>
<span><span class="va">l2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/import_example.html">import_example</a></span><span class="op">(</span><span class="st">"l2.tif"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="reference/raster_helpers.html">raster_resample</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="co"># here we calculate an euclidean distance between the two</span></span>
<span><span class="va">l12_cmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CMP.html">CMP</a></span><span class="op">(</span><span class="va">l</span>, <span class="va">l2</span>, fun<span class="op">=</span><span class="va">dist_euclidean_cppr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plots now</span></span>
<span><span class="va">l12_cmp</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="reference/p.html">p</a></span><span class="op">(</span>multi_title <span class="op">=</span> <span class="st">"Monoscale maps (euclidean distance)"</span><span class="op">)</span>  <span class="co"># monoscale maps</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l12_cmp</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/app.html" class="external-link">app</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="reference/p.html">p</a></span><span class="op">(</span>multi_title <span class="op">=</span> <span class="st">"Multiscale maps (averaged)"</span><span class="op">)</span> <span class="co"># multiscale map</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-2.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l12_cmp</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="reference/ms_profile.html">ms_profile</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># profile plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-3.png" width="100%"></p>
<p>An html version of this vignette and of the doc lives <a href="https://vbonhomme.github.io/mucha/" class="uri">https://vbonhomme.github.io/mucha/</a> Feel free to report bugs and suggest features on the github repo <a href="https://github.com/vbonhomme/mucha" class="external-link uri">https://github.com/vbonhomme/mucha</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/vbonhomme/mucha/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/vbonhomme/mucha/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mucha</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Vincent Bonhomme <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-2742-6349" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Cedric Gaucherel <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-4521-8914" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vincent Bonhomme, Cedric Gaucherel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
